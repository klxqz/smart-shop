<script src="{$wa_parent_theme_url}js/jquery.elevateZoom-3.0.8.min.js"></script>
<script src="{$wa_parent_theme_url}javascript/jquery/swipebox/lib/ios-orientationchange-fix.js"></script>
<script src="{$wa_parent_theme_url}javascript/jquery/swipebox/source/jquery.swipebox.min.js"></script>
<link rel="stylesheet" href="{$wa_parent_theme_url}javascript/jquery/swipebox/source/swipebox.css">

<div itemscope itemtype="http://schema.org/Product">
    <h1 itemprop="name">{$product.name}</h1>
    <div class="row product-info">
        <div class="col-sm-6">
            <div class="image">
                <img class="img-responsive" itemprop="image" id="zoom_01" 
                     src="{shopImage::getUrl(['id' => $product.image_id, 'product_id' => $product.id, 'ext' => $product.ext], '350', false)}" 
                     title="{$product.name|escape}" alt="{$product.name|escape}" 
                     data-zoom-image="{shopImage::getUrl(['id' => $product.image_id, 'product_id' => $product.id, 'ext' => $product.ext], '900', false)}" /> 
            </div>
            <div class="center-block text-center ">
                <span class="zoom-gallery"><i class="fa fa-search"></i> Click image for Gallery</span>
            </div>
            <div class="image-additional" id="gallery_01">
                {foreach $product.images as $image}
                    <a class="thumbnail" href="#" data-zoom-image="{shopImage::getUrl(['id' => $image.id, 'product_id' => $product.id, 'ext' => $image.ext], '900', false)}" data-image="{shopImage::getUrl(['id' => $image.id, 'product_id' => $product.id, 'ext' => $image.ext], '350', false)}" title="{$product.name|escape}"> 
                        <img src="{shopImage::getUrl(['id' => $image.id, 'product_id' => $product.id, 'ext' => $image.ext], '66', false)}" title="{$product.name|escape}" alt = "{$product.name|escape}"/>
                    </a>
                {/foreach}
            </div>
            <script type="text/javascript">
                $("#zoom_01").elevateZoom({
                    gallery: 'gallery_01',
                    cursor: 'pointer',
                    galleryActiveClass: 'active',
                    imageCrossfade: true,
                    zoomWindowFadeIn: 500,
                    zoomWindowFadeOut: 500,
                    lensFadeIn: 500,
                    lensFadeOut: 500,
                    loadingIcon: '{$wa_parent_theme_url}image/progress.gif'
                }).load(function () {
                    $(this).removeAttr('style');
                    $('.zoomWrapper').css({
                        'width': $(this).width(),
                        'height': $(this).height()
                    });
                });
                //////pass the images to swipebox
                $("#zoom_01").bind("click", function (e) {
                    var ez = $('#zoom_01').data('elevateZoom');
                    $.swipebox(ez.getGalleryList());
                    return false;
                });</script>
        </div>
        <div class="col-sm-6">

            {include file="product.cart.html" inline}

            <!-- plugin hook: 'frontend_product.block_aux' -->
            {* @event frontend_product.%plugin_id%.block_aux *}
            {foreach $frontend_product as $_}
                {$_.cart}
            {/foreach}

            <div class="rating" itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
                <meta itemprop="ratingValue" content="0" />
                <p>
                    {for $i = 1 to 5}
                        <span class="fa fa-stack">
                            {if $i <= $product.rating}
                                <i class="fa fa-star fa-stack-1x"></i>
                            {/if}
                            <i class="fa fa-star-o fa-stack-1x"></i>
                        </span>
                    {/for}

                    <a class="write-review-button" href="#">[`Отзывов`]: <span itemprop="reviewCount">{$reviews_total_count}</span></a> / 
                    <a class="write-review-button" href="#">[`Write a review`]</a>
                    <script type="text/javascript">
                        $(document).ready(function () {
                            $('.write-review-button').click(function () {
                                $('a[href=\"#tab-review\"]').trigger('click');
                                $("html, body").animate({
                                    scrollTop: $('.nav.nav-tabs').offset().top
                                }, "slow");
                                return false;
                            });
                        });
                    </script>

                </p>
            </div>
            <hr>
            <!-- AddThis Button BEGIN -->
            {*
            <div class="addthis_toolbox addthis_default_style"> <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a> <a class="addthis_button_tweet"></a> <a class="addthis_button_google_plusone" g:plusone:size="medium"></a> <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal" pi:pinit:url="http://www.addthis.com/features/pinterest" pi:pinit:media="http://www.addthis.com/cms-content/images/features/pinterest-lg.png"></a> <a class="addthis_counter addthis_pill_style"></a> </div>
            <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-514863386b357649"></script>
            *}
            <!-- AddThis Button END -->
        </div>
    </div>
    <ul class="nav nav-tabs">
        <li class="active">
            <a href="#tab-description" data-toggle="tab">[`Description`]</a>
        </li>
        <li>
            <a href="#tab-features" data-toggle="tab">[`Features`]</a>
        </li>
        <li>
            <a href="#tab-review" data-toggle="tab">[`Reviews`]</a>
        </li>
        {foreach $product.pages as $page}
            <li>
                <a href="#page-{$page.url}" data-toggle="tab">{$page.name}</a>
            </li>
        {/foreach}
    </ul>
    <div class="tab-content">
        <div class="tab-pane active" id="tab-description" itemprop="description">
            <div class="cpt_product_description ">
                {$product.description}
            </div>
        </div>
        <div class="tab-pane" id="tab-features">
            <table class="table table-striped">
                <tbody>
                    {foreach $product.features as $f_code => $f_value}    
                        <tr{if $features[$f_code].type == 'divider'} class="divider"{/if}>
                            <td class="name">
                                <strong>{$features[$f_code].name|escape}</strong>
                            </td>
                            <td class="value" itemprop="{$f_code|escape}">
                                {if is_array($f_value)}
                                    {if $features[$f_code].type == 'color'}
                                        {implode('<br /> ', $f_value)}
                                    {else}
                                        {implode(', ', $f_value)}
                                    {/if}
                                {else}
                                    {$f_value}
                                {/if}
                            </td>
                        </tr>
                    {/foreach}
                </tbody>
            </table>
        </div>
        <div id="tab-review" class="tab-pane">

            <div id="review">
                <div>
                    {$theme_settings.product_reviews_display_mode = 'product_page'}
                    {if $theme_settings.product_reviews_display_mode == 'separate_page'}
                        {if !empty($reviews)}
                            {foreach $reviews as $review}
                                {include file="review.html" reply_allowed=false inline}
                            {/foreach}
                        {/if}

                        {if empty($reviews)}
                            <p>{sprintf('[`Be the first to <a href="%s">write a review</a> of this product!`]', 'reviews/')}</p>
                        {else}
                            {sprintf(_w(
                            'Read <a href="%s">all %d review</a> on %s', 
                            'Read <a href="%s">all %d reviews</a> on %s', 
                            $reviews_total_count, false
                        ), 'reviews/', $reviews_total_count, $product.name|escape)
                            }
                        {/if}            
                    {/if}
                </div>
                <div class="text-right"></div>
            </div>
            {if $theme_settings.product_reviews_display_mode == 'product_page'}
                <script type="text/javascript" src="{$wa_app_static_url}js/rate.widget.js"></script>
                <script type="text/javascript">
                    var product_reviews_display_mode = 'product_page';
                    var product_url = '{$wa->shop->productUrl($product)}';
                </script>
            {/if}
        </div>
        {foreach $product.pages as $page}
            <div class="tab-pane" id="page-{$page.url}">
                <div class="cpt_product_description ">
                    {$page.content}
                </div>
            </div>
        {/foreach}
    </div>


    {$upselling = $product->upSelling()}
    {$crossselling = $product->crossSelling()}
    {if $upselling}
        {include file="products-list.html" products=$upselling list_title='Рекомендуемые товары' class='owl-carousel upselling_pro'}
        <script type="text/javascript">
            $(document).ready(function () {
                $(".owl-carousel.upselling_pro").owlCarousel({
                    itemsCustom: [[320, 1], [600, 2], [768, 3], [992, 5], [1199, 5]],
                    lazyLoad: true,
                    navigation: true,
                    navigationText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
                    scrollPerPage: true
                });
            });
        </script>
    {/if}
    {if $crossselling}
        {include file="products-list.html" products=$crossselling list_title='Также покупают' class='owl-carousel crossselling_pro'}
        <script type="text/javascript">
            $(document).ready(function () {
                $(".owl-carousel.crossselling_pro").owlCarousel({
                    itemsCustom: [[320, 1], [600, 2], [768, 3], [992, 5], [1199, 5]],
                    lazyLoad: true,
                    navigation: true,
                    navigationText: ['<i class="fa fa-angle-left"></i>', '<i class="fa fa-angle-right"></i>'],
                    scrollPerPage: true
                });
            });
        </script>
    {/if}
</div>
