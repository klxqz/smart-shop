function showMsg(t,a){void 0===a&&(a="success"),noty({text:t,type:a,dismissQueue:!0,layout:"bottomLeft",closeWith:["click"],maxVisible:5,theme:"relax",timeout:5e3,animation:{open:"animated bounceInLeft",close:"animated bounceOutLeft",easing:"swing",speed:500}})}function initCompare(){$("#content").on("click",".compare-add",function(){var t=$.cookie("shop_compare");t=t?t.split(","):[];var a=$(this).closest(".product-thumb").find(".ajax_product_info"),i=$.inArray($(this).data("id")+"",t);if(-1==i){t.push($(this).data("id"));var e=compare_url.replace(/compare\/.*$/,"compare/"+t.join(",")+"/");showMsg('<i class="fa fa-check-circle"></i> Товар <a href="'+a.data("url")+'">'+a.data("name")+'</a> успешно добавлен в <a href="'+e+'">Список сравнения</a>')}else{t.splice(i,1);var e=compare_url.replace(/compare\/.*$/,"compare/"+t.join(",")+"/");showMsg('<i class="fa fa-check-circle"></i> Товар <a href="'+a.data("url")+'">'+a.data("name")+'</a> удален из <a href="'+e+'">Списка сравнения</a>',"warning")}return $(".compare-total").attr("href",e),$(".compare-total .count").text(t.length),t.length>0?$.cookie("shop_compare",t.join(","),{expires:30,path:"/"}):$.cookie("shop_compare",null,{expires:30,path:"/"}),!1})}function initWishlist(){$("#content").on("click",".wishlist-add",function(){var t=$.cookie("shop_wishlist");t=t?t.split(","):[];var a=$(this).closest(".product-thumb").find(".ajax_product_info"),i=$.inArray($(this).data("id")+"",t);return-1==i?(t.push($(this).data("id")),showMsg('<i class="fa fa-check-circle"></i> Товар <a href="'+a.data("url")+'">'+a.data("name")+'</a> успешно добавлен в <a href="'+wishlist_url+'">Избранное</a>')):(t.splice(i,1),showMsg('<i class="fa fa-check-circle"></i> Товар <a href="'+a.data("url")+'">'+a.data("name")+'</a> удален из <a href="'+wishlist_url+'">Избранного</a>',"warning")),$(".wishlist-total .count").text(t.length),t.length>0?$.cookie("shop_wishlist",t.join(","),{expires:30,path:"/"}):$.cookie("shop_wishlist",null,{expires:30,path:"/"}),!1})}function initRangeSlider(){$(".price_slider").each(function(){if(!$(this).find(".slider-range").length){var t=$(this),a=$('<div class="slider-range"></div>').appendTo(t),i=$('input[name="'+$(this).data("name-min")+'"]'),e=$('input[name="'+$(this).data("name-max")+'"]');a.slider({range:!0,min:t.data("min"),max:t.data("max"),values:[i.val()?i.val():t.data("min"),e.val()?e.val():t.data("max")],slide:function(t,a){var o=a.values[0]==$(this).slider("option","min")?"":a.values[0];i.val(o),o=a.values[1]==$(this).slider("option","max")?"":a.values[1],e.val(o)},stop:function(t,a){i.change()}}),i.add(e).change(function(){var t=""===i.val()?a.slider("option","min"):parseFloat(i.val()),o=""===e.val()?a.slider("option","max"):parseFloat(e.val());o>=t&&a.slider("option","values",[t,o])})}})}$(document).ready(function(){if($(document).on("click",".quick-view",function(){var t=$("#dialog"),a=$('<div class="product-info"></div>');return a.html('<i class="icon32 loading"><i>'),t.find(".content").html(a),a.load($(this).attr("href")+"?cart=1&quick_view=1",function(){a.prepend('<a href="#" class="dialog-close">&times;</a>')}),t.show(),$("html").addClass("dialog-open"),!1}),$(document).on("click",".product-image-next",function(){var t=$(this).closest(".image").find("img"),a=$(this).closest(".product-image-buttons").data("images"),i=a.indexOf(t.attr("src"));return i<a.length-1?i++:i=0,t.hide(),t.after('<i class="icon16 loading"><i>'),t.attr("src",a[i]),t.one("load",function(){$(this).next(".loading").remove(),$(this).show()}),!1}),$(document).on("click",".product-image-prev",function(){var t=$(this).closest(".image").find("img"),a=$(this).closest(".product-image-buttons").data("images"),i=a.indexOf(t.attr("src"));return i>0?i--:i=a.length-1,t.attr("src",a[i]),!1}),$("#clear-wishlist").click(function(){return $.cookie("shop_wishlist","",{expires:0,path:"/"}),location.reload(),!1}),$("#currency a").click(function(){var t=location.href;return t+=-1==t.indexOf("?")?"?":"&",location.href=t+"currency="+$(this).data("code"),!1}),$(".option_box .option_name").click(function(){var t=$.cookie("shop_filter_collapsible");t=t?t.split(","):[];var a=$.inArray($(this).data("filter")+"",t);$(this).hasClass("hided")&&-1!=a?t.splice(a,1):$(this).hasClass("hided")||-1!=a||t.push($(this).data("filter")),t.length>0?$.cookie("shop_filter_collapsible",t.join(","),{expires:30,path:"/"}):$.cookie("shop_filter_collapsible",null,{expires:30,path:"/"}),$(this).siblings(".collapsible").toggle(),$(this).toggleClass("hided")}),$(".filters.ajax input").change(function(){var t=$(".filters.ajax"),a="?"+t.serialize();$(".products-category .product-thumb").append('<div class="loadmask"></div>'),$.get(a+"&_=_",function(t){var i=$("<div></div>").html(t);$(".products-category").html(i.find(".products-category").html()),$(".pagination-block").html(i.find(".pagination-block").html()),"list"==localStorage.getItem("display")?$("#list-view").trigger("click"):$("#grid-view").trigger("click"),history.pushState&&void 0!==history.state&&window.history.pushState({},"",a)})}),initCompare(),initWishlist(),$("#input-sort").change(function(){location.assign($(this).val())}),$("#input-limit").change(function(){$(this).val()?$.cookie("products_per_page",$(this).val(),{expires:30,path:"/"}):$.cookie("products_per_page","",{expires:0,path:"/"}),location.reload()}),$("#content").on("submit","form.addtocart",function(){var t=$(this),a=$('<div class="button-overlay"><i class="icon16 loading"></i></div>');if(t.data("url")){$(this).find("button").append(a);var i=$("#dialog"),e=$('<div class="product-info"></div>');return e.html('<i class="icon32 loading"><i>'),i.find(".content").html(e),e.load(t.data("url"),function(){a.remove(),e.prepend('<a href="#" class="dialog-close">&times;</a>')}),i.show(),$("html").addClass("dialog-open"),!1}return $(this).find("button").append(a),$.post(t.attr("action")+"?html=1",t.serialize(),function(i){if(a.remove(),"ok"==i.status){var e=$("#cart-total"),o=t.closest(".product-thumb"),n=o.find(".ajax_product_info");showMsg('<i class="fa fa-check-circle"></i> Товар <a href="'+n.data("url")+'">'+n.data("name")+'</a> успешно добавлен в <a href="'+cart_url+'">корзину</a>');var s=$("<div></div>").append(o.html()),r=e.offset().top;$(window).scrollTop()>e.offset().top&&(r=$(window).scrollTop()),s.css({"z-index":10,top:o.offset().top,left:o.offset().left,width:o.width()+"px",height:o.height()+"px",position:"absolute",overflow:"hidden"}).appendTo("body").animate({top:r,left:e.offset().left,width:0,height:0,opacity:.5},500,function(){$(this).remove(),e.html(i.data.total);var t=$("#cart .cart-items tr[data-id="+i.data.item_id+"]"),a=1;if(t.length)a=parseInt(t.find(".quantity").text())+a,t.find(".quantity").text(a);else{var o={url:n.data("url"),name:n.data("name"),img:n.data("img"),price:n.data("price"),quantity:a,id:i.data.item_id};$("#cart_item_tmpl").tmpl(o).appendTo("#cart .cart-items table tbody"),$("#cart .cart-items").show(),$("#cart .cart-buttons").show(),$("#cart .cart-empty").hide()}$("table.cart").length&&location.reload()}),i.data.error&&alert(i.data.error)}else"fail"==i.status&&alert(i.errors)},"json"),!1}),$.fn.lazyLoad){var t=$(".lazyloading-paging");if(!t.length)return;var a=t.find("li.selected");if("1"!=a.children("a").text())return;t.hide();var i=t.data("loading-str")||"Loading...",e=$(window);e.lazyLoad("stop");var o=a.next();o.length&&e.lazyLoad({container:"#content",load:function(){e.lazyLoad("sleep");var t=$(".lazyloading-paging").hide(),a=t.find("li.selected"),o=a.next(),n=o.find("a").attr("href");if(!n)return void e.lazyLoad("stop");var s=$(".products-category"),r=t.parent().find(".loading").parent();r.length||(r=$('<div><i class="icon16 loading"></i>'+i+"</div>").insertBefore(t)),r.show(),$.get(n,function(a){var i=$("<div></div>").html(a);$.Retina&&i.find("#product-list .product-list img").retina(),s.append(i.find(".products-category").children()),"list"==localStorage.getItem("display")?$("#list-view").trigger("click"):$("#grid-view").trigger("click");var o=i.find(".lazyloading-paging").hide();t.replaceWith(o),t=o;var n=t.find("li.selected"),l=n.next();l.length?e.lazyLoad("wake"):e.lazyLoad("stop"),r.hide(),i.remove()})}})}});